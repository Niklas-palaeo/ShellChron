x11(); plot(MnCaviolin)
MnCaviolin <- ggplot() +
geom_violin(data = long_total[record == "MgCa" & Specimen = "Shell2_1", ],
aes(x = Cycle, y = A, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE)
MnCaviolin <- ggplot() +
geom_violin(data = long_total[record == "MgCa" & Specimen == "Shell2_1", ],
aes(x = Cycle, y = A, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE)
MnCaviolin <- ggplot() +
geom_violin(data = subset(long_total, record == "MgCa", Specimen == "Shell2_1"),
aes(x = Cycle, y = A, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE)
x11(); plot(MnCaviolin)
MnCaviolin <- ggplot() +
geom_violin(data = subset(long_total, record == "MgCa" & Specimen == "Shell2_1"),
aes(x = Cycle, y = A, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE)
x11(); plot(MnCaviolin)
require(xlsx)
require(tidyverse)
require(ggridges)
require(gridExtra)
# Open stats of daily sinusoidal fit
Shell4_MgCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_daily_sinstats.xlsx", sheetName = "MgCa")
Shell4_MnCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_daily_sinstats.xlsx", sheetName = "MnCa")
Shell4_SrCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_daily_sinstats.xlsx", sheetName = "SrCa")
Shell4_BaCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_daily_sinstats.xlsx", sheetName = "BaCa")
Shell2_1_MgCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_daily_sinstats.xlsx", sheetName = "MgCa")
Shell2_1_MnCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_daily_sinstats.xlsx", sheetName = "MnCa")
Shell2_1_SrCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_daily_sinstats.xlsx", sheetName = "SrCa")
Shell2_1_BaCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_daily_sinstats.xlsx", sheetName = "BaCa")
Shell2_2_MgCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_daily_sinstats.xlsx", sheetName = "MgCa")
Shell2_2_MnCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_daily_sinstats.xlsx", sheetName = "MnCa")
Shell2_2_SrCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_daily_sinstats.xlsx", sheetName = "SrCa")
Shell2_2_BaCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_daily_sinstats.xlsx", sheetName = "BaCa")
Shell3_1_MgCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_daily_sinstats.xlsx", sheetName = "MgCa")
Shell3_1_MnCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_daily_sinstats.xlsx", sheetName = "MnCa")
Shell3_1_SrCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_daily_sinstats.xlsx", sheetName = "SrCa")
Shell3_1_BaCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_daily_sinstats.xlsx", sheetName = "BaCa")
Shell3_2_MgCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_daily_sinstats.xlsx", sheetName = "MgCa")
Shell3_2_MnCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_daily_sinstats.xlsx", sheetName = "MnCa")
Shell3_2_SrCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_daily_sinstats.xlsx", sheetName = "SrCa")
Shell3_2_BaCa_day <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_daily_sinstats.xlsx", sheetName = "BaCa")
colnames(Shell3_2_MgCa_day)[1] <-
colnames(Shell3_2_MnCa_day)[1] <-
colnames(Shell3_2_BaCa_day)[1] <-
colnames(Shell3_2_SrCa_day)[1] <-
colnames(Shell3_1_MgCa_day)[1] <-
colnames(Shell3_1_MnCa_day)[1] <-
colnames(Shell3_1_BaCa_day)[1] <-
colnames(Shell3_1_SrCa_day)[1] <-
colnames(Shell2_2_MgCa_day)[1] <-
colnames(Shell2_2_MnCa_day)[1] <-
colnames(Shell2_2_BaCa_day)[1] <-
colnames(Shell2_2_SrCa_day)[1] <-
colnames(Shell2_1_MgCa_day)[1] <-
colnames(Shell2_1_MnCa_day)[1] <-
colnames(Shell2_1_BaCa_day)[1] <-
colnames(Shell2_1_SrCa_day)[1] <-
colnames(Shell4_MgCa_day)[1] <-
colnames(Shell4_MnCa_day)[1] <-
colnames(Shell4_BaCa_day)[1] <-
colnames(Shell4_SrCa_day)[1] <-
"Day" # Label day-column
# Open stats of tidal sinusoidal fit
Shell4_MgCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_tidealigned_sinstats.xlsx", sheetName = "MgCa")
Shell4_MnCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_tidealigned_sinstats.xlsx", sheetName = "MnCa")
Shell4_SrCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_tidealigned_sinstats.xlsx", sheetName = "SrCa")
Shell4_BaCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell4/Shell4_tidealigned_sinstats.xlsx", sheetName = "BaCa")
Shell2_1_MgCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_tidealigned_sinstats.xlsx", sheetName = "MgCa")
Shell2_1_MnCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_tidealigned_sinstats.xlsx", sheetName = "MnCa")
Shell2_1_SrCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_tidealigned_sinstats.xlsx", sheetName = "SrCa")
Shell2_1_BaCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_1/Shell2_1_tidealigned_sinstats.xlsx", sheetName = "BaCa")
Shell2_2_MgCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_tidealigned_sinstats.xlsx", sheetName = "MgCa")
Shell2_2_MnCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_tidealigned_sinstats.xlsx", sheetName = "MnCa")
Shell2_2_SrCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_tidealigned_sinstats.xlsx", sheetName = "SrCa")
Shell2_2_BaCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell2_2/Shell2_2_tidealigned_sinstats.xlsx", sheetName = "BaCa")
Shell3_1_MgCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_tidealigned_sinstats.xlsx", sheetName = "MgCa")
Shell3_1_MnCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_tidealigned_sinstats.xlsx", sheetName = "MnCa")
Shell3_1_SrCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_tidealigned_sinstats.xlsx", sheetName = "SrCa")
Shell3_1_BaCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_1/Shell3_1_tidealigned_sinstats.xlsx", sheetName = "BaCa")
Shell3_2_MgCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_tidealigned_sinstats.xlsx", sheetName = "MgCa")
Shell3_2_MnCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_tidealigned_sinstats.xlsx", sheetName = "MnCa")
Shell3_2_SrCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_tidealigned_sinstats.xlsx", sheetName = "SrCa")
Shell3_2_BaCa_tide <- read.xlsx("E:/Dropbox/Research/postdoc/Side projects/Bivalve photosymbiosis and gigantism/Pectinids_Lukas/Stacks/Shell3_2/Shell3_2_tidealigned_sinstats.xlsx", sheetName = "BaCa")
colnames(Shell3_2_MgCa_tide)[1] <-
colnames(Shell3_2_MnCa_tide)[1] <-
colnames(Shell3_2_BaCa_tide)[1] <-
colnames(Shell3_2_SrCa_tide)[1] <-
colnames(Shell3_1_MgCa_tide)[1] <-
colnames(Shell3_1_MnCa_tide)[1] <-
colnames(Shell3_1_BaCa_tide)[1] <-
colnames(Shell3_1_SrCa_tide)[1] <-
colnames(Shell2_2_MgCa_tide)[1] <-
colnames(Shell2_2_MnCa_tide)[1] <-
colnames(Shell2_2_BaCa_tide)[1] <-
colnames(Shell2_2_SrCa_tide)[1] <-
colnames(Shell2_1_MgCa_tide)[1] <-
colnames(Shell2_1_MnCa_tide)[1] <-
colnames(Shell2_1_BaCa_tide)[1] <-
colnames(Shell2_1_SrCa_tide)[1] <-
colnames(Shell4_MgCa_tide)[1] <-
colnames(Shell4_MnCa_tide)[1] <-
colnames(Shell4_BaCa_tide)[1] <-
colnames(Shell4_SrCa_tide)[1] <-
"Tide" # Label tide-column
# Create long dataframe of R2 values for daily sinusoidal regression
R2_day <- data.frame(
R2 = c(Shell2_1_MgCa_day$R2adj,
Shell2_1_MnCa_day$R2adj,
Shell2_1_SrCa_day$R2adj,
Shell2_1_BaCa_day$R2adj,
Shell2_2_MgCa_day$R2adj,
Shell2_2_MnCa_day$R2adj,
Shell2_2_SrCa_day$R2adj,
Shell2_2_BaCa_day$R2adj,
Shell3_1_MgCa_day$R2adj,
Shell3_1_MnCa_day$R2adj,
Shell3_1_SrCa_day$R2adj,
Shell3_1_BaCa_day$R2adj,
Shell3_2_MgCa_day$R2adj,
Shell3_2_MnCa_day$R2adj,
Shell3_2_SrCa_day$R2adj,
Shell3_2_BaCa_day$R2adj,
Shell4_MgCa_day$R2adj,
Shell4_MnCa_day$R2adj,
Shell4_SrCa_day$R2adj,
Shell4_BaCa_day$R2adj
),
pval = c(Shell2_1_MgCa_day$p,
Shell2_1_MnCa_day$p,
Shell2_1_SrCa_day$p,
Shell2_1_BaCa_day$p,
Shell2_2_MgCa_day$p,
Shell2_2_MnCa_day$p,
Shell2_2_SrCa_day$p,
Shell2_2_BaCa_day$p,
Shell3_1_MgCa_day$p,
Shell3_1_MnCa_day$p,
Shell3_1_SrCa_day$p,
Shell3_1_BaCa_day$p,
Shell3_2_MgCa_day$p,
Shell3_2_MnCa_day$p,
Shell3_2_SrCa_day$p,
Shell3_2_BaCa_day$p,
Shell4_MgCa_day$p,
Shell4_MnCa_day$p,
Shell4_SrCa_day$p,
Shell4_BaCa_day$p
),
A = c(Shell2_1_MgCa_day$A,
Shell2_1_MnCa_day$A,
Shell2_1_SrCa_day$A,
Shell2_1_BaCa_day$A,
Shell2_2_MgCa_day$A,
Shell2_2_MnCa_day$A,
Shell2_2_SrCa_day$A,
Shell2_2_BaCa_day$A,
Shell3_1_MgCa_day$A,
Shell3_1_MnCa_day$A,
Shell3_1_SrCa_day$A,
Shell3_1_BaCa_day$A,
Shell3_2_MgCa_day$A,
Shell3_2_MnCa_day$A,
Shell3_2_SrCa_day$A,
Shell3_2_BaCa_day$A,
Shell4_MgCa_day$A,
Shell4_MnCa_day$A,
Shell4_SrCa_day$A,
Shell4_BaCa_day$A
),
record = c(rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell2_1_BaCa_day$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell2_2_BaCa_day$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell3_1_BaCa_day$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell3_2_BaCa_day$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell4_BaCa_day$R2adj))
),
Specimen = c(rep("Shell2_1", 4 * length(Shell2_1_BaCa_day$R2adj)),
rep("Shell2_2", 4 * length(Shell2_2_BaCa_day$R2adj)),
rep("Shell3_1", 4 * length(Shell3_1_BaCa_day$R2adj)),
rep("Shell3_2", 4 * length(Shell3_2_BaCa_day$R2adj)),
rep("Shell4", 4 * length(Shell4_BaCa_day$R2adj))
),
Cycle = rep("day", 4 * sum(length(Shell2_1_BaCa_day$R2adj), length(Shell2_2_BaCa_day$R2adj), length(Shell3_1_BaCa_day$R2adj), length(Shell3_2_BaCa_day$R2adj), length(Shell4_BaCa_day$R2adj)))
)
# Create long dataframe of R2 values for daily sinusoidal regression
R2_tide <- data.frame(
R2 = c(Shell2_1_MgCa_tide$R2adj,
Shell2_1_MnCa_tide$R2adj,
Shell2_1_SrCa_tide$R2adj,
Shell2_1_BaCa_tide$R2adj,
Shell2_2_MgCa_tide$R2adj,
Shell2_2_MnCa_tide$R2adj,
Shell2_2_SrCa_tide$R2adj,
Shell2_2_BaCa_tide$R2adj,
Shell3_1_MgCa_tide$R2adj,
Shell3_1_MnCa_tide$R2adj,
Shell3_1_SrCa_tide$R2adj,
Shell3_1_BaCa_tide$R2adj,
Shell3_2_MgCa_tide$R2adj,
Shell3_2_MnCa_tide$R2adj,
Shell3_2_SrCa_tide$R2adj,
Shell3_2_BaCa_tide$R2adj,
Shell4_MgCa_tide$R2adj,
Shell4_MnCa_tide$R2adj,
Shell4_SrCa_tide$R2adj,
Shell4_BaCa_tide$R2adj
),
pval = c(Shell2_1_MgCa_tide$p,
Shell2_1_MnCa_tide$p,
Shell2_1_SrCa_tide$p,
Shell2_1_BaCa_tide$p,
Shell2_2_MgCa_tide$p,
Shell2_2_MnCa_tide$p,
Shell2_2_SrCa_tide$p,
Shell2_2_BaCa_tide$p,
Shell3_1_MgCa_tide$p,
Shell3_1_MnCa_tide$p,
Shell3_1_SrCa_tide$p,
Shell3_1_BaCa_tide$p,
Shell3_2_MgCa_tide$p,
Shell3_2_MnCa_tide$p,
Shell3_2_SrCa_tide$p,
Shell3_2_BaCa_tide$p,
Shell4_MgCa_tide$p,
Shell4_MnCa_tide$p,
Shell4_SrCa_tide$p,
Shell4_BaCa_tide$p
),
A = c(Shell2_1_MgCa_tide$A,
Shell2_1_MnCa_tide$A,
Shell2_1_SrCa_tide$A,
Shell2_1_BaCa_tide$A,
Shell2_2_MgCa_tide$A,
Shell2_2_MnCa_tide$A,
Shell2_2_SrCa_tide$A,
Shell2_2_BaCa_tide$A,
Shell3_1_MgCa_tide$A,
Shell3_1_MnCa_tide$A,
Shell3_1_SrCa_tide$A,
Shell3_1_BaCa_tide$A,
Shell3_2_MgCa_tide$A,
Shell3_2_MnCa_tide$A,
Shell3_2_SrCa_tide$A,
Shell3_2_BaCa_tide$A,
Shell4_MgCa_tide$A,
Shell4_MnCa_tide$A,
Shell4_SrCa_tide$A,
Shell4_BaCa_tide$A
),
record = c(rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell2_1_BaCa_tide$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell2_2_BaCa_tide$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell3_1_BaCa_tide$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell3_2_BaCa_tide$R2adj)),
rep(c("MgCa", "MnCa", "SrCa", "BaCa"), each = length(Shell4_BaCa_tide$R2adj))
),
Specimen = c(rep("Shell2_1", 4 * length(Shell2_1_BaCa_tide$R2adj)),
rep("Shell2_2", 4 * length(Shell2_2_BaCa_tide$R2adj)),
rep("Shell3_1", 4 * length(Shell3_1_BaCa_tide$R2adj)),
rep("Shell3_2", 4 * length(Shell3_2_BaCa_tide$R2adj)),
rep("Shell4", 4 * length(Shell4_BaCa_tide$R2adj))
),
Cycle = rep("tide", 4 * sum(length(Shell2_1_BaCa_tide$R2adj), length(Shell2_2_BaCa_tide$R2adj), length(Shell3_1_BaCa_tide$R2adj), length(Shell3_2_BaCa_tide$R2adj), length(Shell4_BaCa_tide$R2adj)))
)
# Plot R2_adj violin plots for daily fits
R2violin_day <- ggplot() +
geom_violin(data = subset(R2_day, Specimen == "Shell2_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell2_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell3_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell3_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell4"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_boxplot(data = R2_day,
aes(x = record, y = R2),
width = 0.1) +
scale_y_continuous("adjusted R2", limits = c(-0.5, 1.5), breaks = seq(0, 1, 0.1)) +
scale_fill_brewer(palette = "PRGn") +
ggtitle("Daily cyclicity fits")
# Plot R2_adj violin plots for tidal fits
R2violin_tide <- ggplot() +
geom_violin(data = subset(R2_tide, Specimen == "Shell2_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell2_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell3_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell3_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell4"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_boxplot(data = R2_tide,
aes(x = record, y = R2),
width = 0.1) +
scale_y_continuous("adjusted R2", limits = c(-0.5, 1.5), breaks = seq(0, 1, 0.1)) +
scale_fill_brewer(palette = "PRGn") +
ggtitle("Tidal cyclicity fits")
x11(); plot(R2violin_day)
R2violin_both <- grid.arrange(R2violin_day, R2violin_tide, ncol = 2)
R2violin_day <- ggplot() +
geom_violin(data = subset(R2_day, Specimen == "Shell2_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell2_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell3_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell3_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell4"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_boxplot(data = R2_day,
aes(x = record, y = R2),
width = 0.1) +
scale_y_continuous("adjusted R2", limits = c(-0.5, 1.5), breaks = seq(0, 1, 0.1)) +
scale_fill_brewer(palette = "PRGn") +
theme(lengend.position = "none") +
ggtitle("Daily cyclicity fits")
# Plot R2_adj violin plots for tidal fits
R2violin_tide <- ggplot() +
geom_violin(data = subset(R2_tide, Specimen == "Shell2_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell2_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell3_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell3_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell4"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_boxplot(data = R2_tide,
aes(x = record, y = R2),
width = 0.1) +
scale_y_continuous("adjusted R2", limits = c(-0.5, 1.5), breaks = seq(0, 1, 0.1)) +
scale_fill_brewer(palette = "PRGn") +
ggtitle("Tidal cyclicity fits")
# Combine plots
R2violin_both <- grid.arrange(R2violin_day, R2violin_tide, ncol = 2)
R2violin_day <- ggplot() +
geom_violin(data = subset(R2_day, Specimen == "Shell2_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell2_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell3_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell3_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_day, Specimen == "Shell4"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_boxplot(data = R2_day,
aes(x = record, y = R2),
width = 0.1) +
scale_y_continuous("adjusted R2", limits = c(-0.5, 1.5), breaks = seq(0, 1, 0.1)) +
scale_fill_brewer(palette = "PRGn") +
theme(legend.position = "none") +
ggtitle("Daily cyclicity fits")
# Plot R2_adj violin plots for tidal fits
R2violin_tide <- ggplot() +
geom_violin(data = subset(R2_tide, Specimen == "Shell2_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell2_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell3_1"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell3_2"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_violin(data = subset(R2_tide, Specimen == "Shell4"),
aes(x = record, y = R2, fill = Specimen),
color = NA,
scale = 1,
alpha = 0.25,
trim = FALSE) +
geom_boxplot(data = R2_tide,
aes(x = record, y = R2),
width = 0.1) +
scale_y_continuous("adjusted R2", limits = c(-0.5, 1.5), breaks = seq(0, 1, 0.1)) +
scale_fill_brewer(palette = "PRGn") +
ggtitle("Tidal cyclicity fits")
# Combine plots
R2violin_both <- grid.arrange(R2violin_day, R2violin_tide, ncol = 2)
x11(); plot(R2violin_both)
